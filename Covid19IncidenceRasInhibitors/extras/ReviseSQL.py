import glob, sys, os

(old_dir,new_dir) = sys.argv[1:3]

for in_file in glob.glob(old_dir + 'COVID_ACE_ID*.sql'):
	print "Sql:", in_file
	out_file = new_dir + '/' + os.path.basename(in_file)
	print "Sql:", out_file

 	fin = open(in_file, "rt")
 	fout = open(out_file, "wt")

	for line in fin:
		fout.write(line.
		# [LEGEND] ACE inhibitors
		replace('(1340128,1341927,1363749,1308216,1373225,1334456,1335471,1310756,1331235,1342439)',
				'(1340128,1341927,1363749,1308216,1373225,1334456,1335471,1310756,1331235,1342439,19122327)').
		# [LEGEND] ACE inhibitors & ARBs
		replace('(1340128,1341927,1363749,1308216,1367500,1373225,1334456,40235485,1335471,1351557,1346686,1347384,1310756,40226742,1331235,1317640,1342439,1308842)',
			 	'(1340128,1341927,1363749,1308216,1367500,1373225,1334456,40235485,1335471,1351557,1346686,1347384,1310756,40226742,1331235,1317640,1342439,1308842,19122327)').
    	# [LEGEND] dCCBs and thiazides/thiazide-like diuretics
	    replace('(1332418,1395058,1353776,974166,978555,1326012,907013,1318137,1318853,1319880)',
    	        '(1332418,1395058,1353776,974166,978555,1326012,907013,1318137,1318853,1319880,19015802,19004539,19071995,1316354,19010493)').
	    # [LEGEND] Thiazide or thiazide-like diuretics
	    replace('(1395058,974166,978555,907013)',
    	        '(1395058,974166,978555,907013,1316354,19010493)').
	    # [LEGEND] Dihydropyridine calcium channel blockers (dCCB)
	    replace('(1332418,1353776,1326012,1318137,1318853,1319880)',
	            '(1332418,1353776,1326012,1318137,1318853,1319880,19004539,19015802,19071995)'))

	fin.close()
	fout.close()
